# CodeQL Configuration for Rust-cola
# This configuration uses an explicit include list to scan only production code.
# Test crates with intentional vulnerabilities are excluded by omission.

name: "CodeQL Config for Rust-cola"

# Disable specific queries that produce false positives in our detection code
# These queries flag pattern strings in our security rules, not actual vulnerabilities
disable-default-queries: false
query-filters:
  - exclude:
      id: rust/weak-cryptographic-algorithm
  - exclude:
      id: rust/insufficient-random-values

# Paths to include in analysis (production code only)
# All other paths, especially examples/* with test vulnerabilities, are excluded by default
paths:
  - mir-extractor
  - mir-advanced-rules
  - cargo-cola
  - docs

# Additional exclusions to ensure test crates are never analyzed
# These directories contain intentional vulnerabilities for testing Rust-cola detection rules
paths-ignore:
  - 'examples/**'
  - 'mir_dump/**'
  - 'test_output/**'
  - 'out/**'
  - 'target/**'

# Note: The examples/ directory contains test crates with intentional vulnerabilities
# for testing Rust-cola security detection rules. These are excluded from CodeQL
# analysis to prevent false positives in the security dashboard.
